---
title: Security Policy
summary: Базовые требования безопасности для сервисов AquaStream.
tags: [operations, security, policy]
---

# Политика безопасности

## Принципы

1. **Минимально необходимые права**: используем только те доступы, которые нужны для текущей задачи.
2. **Разделение секретов**: прод-значения не смешиваются с локальными `.env`.
3. **Defense in Depth**: шифрование, хардненые контейнеры, наблюдаемость.
4. **Zero Trust**: каждое обращение проверяется токенами/ключами.

## Контроль доступа

| Система | Механизм | Политика |
|---------|----------|----------|
| GitHub | 2FA + персональные токены | Доступ только владельцу репозитория |
| CI/CD | GitHub Secrets | Секреты заданы через репозиторий, без хардкода |
| Секреты | `.env.*` + менеджер паролей | Регулярная ротация при компрометации |
| Базы данных | Отдельные роли | Read-only для локальной отладки, prod доступ по необходимости |

## Обработка секретов

- Секреты не коммитятся в репозиторий.
- Используем `.env.*.example` как шаблоны.
- Для production — зашифрованное хранилище (Vault/1Password/Bitwarden).
- Проверка утечек: `gitleaks` в CI (`make scan-secrets`).

## Шифрование

- **В движении**: HTTPS/TLS 1.3, `Strict-Transport-Security` (макс. срок 180 дней).
- **В покое**: PostgreSQL (pgcrypto), MinIO (SSE-S3/SSE-KMS), Redis (TLS + auth).
- **API**: JWT с RS256, refresh токены с exp 14 дней.

## Логирование и аудит

- Обязательные поля: timestamp, service, userId, correlationId, event.
- Чувствительные данные редактируются (masking/obfuscation).
- Audit trail хранится 180 дней.
- Доступ к логам ограничен через Grafana RBAC.

## Управление уязвимостями

- Trivy — автоматически в CI/стендах (`make scan`).
- Dependabot — обновления зависимостей (ежедневно).
- Ежеквартальные пен-тесты (внешний подрядчик).
- SLA на исправление: CRITICAL — 24ч, HIGH — 3 дня, MEDIUM — 14 дней, LOW — 30 дней.

## Инциденты безопасности

1. Зафиксировать инцидент в GitHub Issue/личном журнале (дата, что произошло).
2. Отозвать доступы (JWT, токены, ключи), пересоздать секреты.
3. Проанализировать логи/метрики, определить причину.
4. Выполнить hotfix, задеплоить, убедиться что метрики в норме.
5. Обновить документацию и чек-листы (см. [Incident Response Runbook](../runbooks/incident-response.md)).

## Самостоятельный аудит

- Раз в квартал выполнять `make scan` и `gitleaks` локально.
- Перепроверять списки доступа, удалять неиспользуемые ключи.
- Освежать знания по secure coding (см. `development/style-guides.md`).

## Ссылки

- [Development Style Guides](../../development/style-guides.md)
- [Operations Monitoring](../monitoring.md)
- [Incident Response](../runbooks/incident-response.md)
