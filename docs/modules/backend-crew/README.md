# AquaStream Backend Crew Service

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç–∫–∏–ø–∞–∂–∞–º–∏, –≥—Ä—É–ø–ø–∞–º–∏, –ª–æ–¥–∫–∞–º–∏, –ø–∞–ª–∞—Ç–∫–∞–º–∏ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π AquaStream.

## –û–ø–∏—Å–∞–Ω–∏–µ

`backend-crew` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –≥—Ä—É–ø–ø —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –ø–æ—Ö–æ–¥–∞—Ö –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö: —ç–∫–∏–ø–∞–∂–∏ –ª–æ–¥–æ–∫, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–∞–ª–∞—Ç–∫–∞–º, —Ä–∞—Å—Å–∞–¥–∫–∞ –∑–∞ —Å—Ç–æ–ª–∞–º–∏, –º–µ—Å—Ç–∞ –≤ –∞–≤—Ç–æ–±—É—Å–µ. –°–µ—Ä–≤–∏—Å —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –º–æ–¥–µ–ª–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú—É–ª—å—Ç–∏–º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
backend-crew/
‚îú‚îÄ‚îÄ backend-crew-api/        # REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏ DTO
‚îÇ   ‚îú‚îÄ‚îÄ controller/          # REST endpoints
‚îÇ   ‚îú‚îÄ‚îÄ dto/                # Data Transfer Objects
‚îÇ   ‚îî‚îÄ‚îÄ exception/          # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
‚îú‚îÄ‚îÄ backend-crew-service/    # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ service/            # –ë–∏–∑–Ω–µ—Å-—Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ mapper/             # Entity ‚Üî DTO –º–∞–ø–ø–∏–Ω–≥
‚îÇ   ‚îî‚îÄ‚îÄ exception/          # –ë–∏–∑–Ω–µ—Å-–∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îî‚îÄ‚îÄ backend-crew-db/        # –°–ª–æ–π –¥–∞–Ω–Ω—ã—Ö
    ‚îú‚îÄ‚îÄ entity/             # JPA Entity –∫–ª–∞—Å—Å—ã
    ‚îú‚îÄ‚îÄ repository/         # Spring Data JPA —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
    ‚îî‚îÄ‚îÄ migration/          # Liquibase –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
```

### –¢–∏–ø—ã –≥—Ä—É–ø–ø

#### üö£ CREW - –≠–∫–∏–ø–∞–∂–∏ –ª–æ–¥–æ–∫
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫–∏–ø–∞–∂–∞–º–∏ –±–∞–π–¥–∞—Ä–æ–∫, –∫–∞—Ç–∞–º–∞—Ä–∞–Ω–æ–≤, —Ä–∞—Ñ—Ç–æ–≤
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π: –∫–∞–ø–∏—Ç–∞–Ω, —à—Ç—É—Ä–º–∞–Ω, –≥—Ä–µ–±–µ—Ü
- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ª–æ–¥–∫–µ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
- –£—á–µ—Ç –æ–ø—ã—Ç–∞ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

#### üèïÔ∏è TENT - –ü–∞–ª–∞—Ç–∫–∏
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–∞–ª–∞—Ç–∫–∞–º –≤ –ø–æ—Ö–æ–¥–∞—Ö
- –£—á–µ—Ç –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ø–∞–ª–∞—Ç–æ–∫
- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —Å–æ—Å–µ–¥—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º –ø–∞–ª–∞—Ç–æ–∫

#### üçΩÔ∏è TABLE - –°—Ç–æ–ª—ã –Ω–∞ –±–∞–Ω–∫–µ—Ç–∞—Ö
- –†–∞—Å—Å–∞–¥–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∑–∞ —Å—Ç–æ–ª–∞–º–∏
- –ù–æ–º–µ—Ä–∞—Ü–∏—è –º–µ—Å—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –£—á–µ—Ç –¥–∏–µ—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π

#### üöå BUS - –ú–µ—Å—Ç–∞ –≤ –∞–≤—Ç–æ–±—É—Å–µ
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç –≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ
- –ù–æ–º–µ—Ä–∞—Ü–∏—è —Å–∏–¥–µ–Ω–∏–π
- –£—á–µ—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—é

## –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

#### CrewEntity - –ì—Ä—É–ø–ø—ã
- **id** - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- **eventId** - –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ
- **name** - –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
- **type** - –¢–∏–ø (CREW, TENT, TABLE, BUS)
- **capacity** - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- **currentSize** - –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- **metadata** - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (JSON)

#### CrewAssignmentEntity - –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è
- **crewId** - –°—Å—ã–ª–∫–∞ –Ω–∞ –≥—Ä—É–ø–ø—É
- **userId** - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **bookingId** - –°—Å—ã–ª–∫–∞ –Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- **seatNumber** - –ù–æ–º–µ—Ä –º–µ—Å—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **position** - –†–æ–ª—å –≤ –≥—Ä—É–ø–ø–µ
- **status** - –°—Ç–∞—Ç—É—Å: ACTIVE, REMOVED, TRANSFERRED

#### BoatEntity - –õ–æ–¥–∫–∏
- **crewId** - –°–≤—è–∑—å —Å –≥—Ä—É–ø–ø–æ–π (1:1)
- **boatType** - –¢–∏–ø –ª–æ–¥–∫–∏
- **brand, model** - –ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å
- **condition** - –°–æ—Å—Ç–æ—è–Ω–∏–µ –ª–æ–¥–∫–∏
- **equipment** - –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (JSON)

#### TentEntity - –ü–∞–ª–∞—Ç–∫–∏
- **crewId** - –°–≤—è–∑—å —Å –≥—Ä—É–ø–ø–æ–π (1:1)
- **tentType** - –¢–∏–ø –ø–∞–ª–∞—Ç–∫–∏
- **seasonRating** - –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å (1-4 —Å–µ–∑–æ–Ω–∞)
- **capacityPersons** - –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ª—é–¥–µ–π
- **equipment** - –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (JSON)

### –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞

#### –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã –ë–î
- –ñ–µ—Å—Ç–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è capacity
- –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø—ã

#### –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π
- –û–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π assignment –Ω–∞ booking
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –º–µ—Å—Ç –≤ –≥—Ä—É–ø–ø–µ
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–≤–æ–π–Ω—ã—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π

#### –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥
- –ê–ª–≥–æ—Ä–∏—Ç–º —É—á–∏—Ç—ã–≤–∞–µ—Ç –∂–µ–ª–∞–µ–º—ã—Ö/–Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–æ—Å–µ–¥–µ–π
- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º –≥—Ä—É–ø–ø –∏ –ø–æ–∑–∏—Ü–∏—è–º
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏–∑–±–µ–≥–∞–Ω–∏—è –Ω–∞–¥ –∂–µ–ª–∞–Ω–∏–µ–º

## API Endpoints

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏

#### `GET /api/v1/events/{eventId}/crews`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≥—Ä—É–ø–ø –¥–ª—è —Å–æ–±—ã—Ç–∏—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `type` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –≥—Ä—É–ø–ø—ã
- `availableOnly` - —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä—É–ø–ø—ã

#### `POST /api/v1/events/{eventId}/crews`
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥—Ä—É–ø–ø—ã

```json
{
  "name": "–≠–∫–∏–ø–∞–∂ ‚Ññ1",
  "type": "CREW",
  "capacity": 4,
  "description": "–û–ø—ã—Ç–Ω—ã–π —ç–∫–∏–ø–∞–∂",
  "boat": {
    "boatType": "–ö–∞—Ç–∞–º–∞—Ä–∞–Ω",
    "brand": "–¢—Ä–∏—Ç–æ–Ω",
    "model": "K-4"
  }
}
```

#### `PUT /api/v1/crews/{crewId}`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã

#### `DELETE /api/v1/crews/{crewId}`
–£–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–¥–∫–∞–º–∏

#### `GET /api/v1/events/{eventId}/boats`
–°–ø–∏—Å–æ–∫ –ª–æ–¥–æ–∫ –¥–ª—è —Å–æ–±—ã—Ç–∏—è

#### `POST /api/v1/boats`
–°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–¥–∫–∏

#### `PUT /api/v1/boats/{boatId}`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ª–æ–¥–∫–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–ª–∞—Ç–∫–∞–º–∏

#### `GET /api/v1/events/{eventId}/tents`
–°–ø–∏—Å–æ–∫ –ø–∞–ª–∞—Ç–æ–∫ –¥–ª—è —Å–æ–±—ã—Ç–∏—è

#### `POST /api/v1/tents`
–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ª–∞—Ç–∫–∏

#### `PUT /api/v1/tents/{tentId}`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ø–∞–ª–∞—Ç–∫–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è–º–∏

#### `POST /api/v1/assignments`
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ –≥—Ä—É–ø–ø—É

```json
{
  "crewId": "crew-uuid",
  "userId": "user-uuid",
  "bookingId": "booking-uuid",
  "seatNumber": 1,
  "position": "captain"
}
```

#### `DELETE /api/v1/assignments/{assignmentId}`
–û—Ç–º–µ–Ω–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

#### `GET /api/v1/assignments/crews/{crewId}`
–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≥—Ä—É–ø–ø—ã

#### `GET /api/v1/assignments/users/{userId}`
–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```gradle
dependencies {
    implementation project(':backend-crew:backend-crew-api')
    implementation project(':backend-crew:backend-crew-service')
    implementation project(':backend-crew:backend-crew-db')
}
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/aquastream
    username: aquastream_user
    password: ${DB_PASSWORD}
  
  liquibase:
    change-log: classpath:migration/liquibase/master.xml
    default-schema: crew

server:
  port: 8103

aquastream:
  crew:
    auto-assignment: true
    capacity-buffer: 0.1
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∏–ø–∞–∂–∞ –¥–ª—è —Å–ø–ª–∞–≤–∞

```java
@Autowired
private CrewService crewService;

// –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∏–ø–∞–∂–∞
CreateCrewDto crewDto = CreateCrewDto.builder()
    .name("–≠–∫–∏–ø–∞–∂ –ú–æ–ª–Ω–∏—è")
    .type(CrewType.CREW)
    .capacity(4)
    .description("–°–∫–æ—Ä–æ—Å—Ç–Ω–æ–π —ç–∫–∏–ø–∞–∂")
    .boat(CreateBoatDto.builder()
        .boatType("–†–∞—Ñ—Ç")
        .brand("AIRE")
        .model("Super Puma")
        .build())
    .build();

CrewDto crew = crewService.createCrew(eventId, crewDto);
```

#### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞

```java
@Autowired
private AssignmentService assignmentService;

CreateAssignmentDto assignment = CreateAssignmentDto.builder()
    .crewId(crewId)
    .userId(userId)
    .bookingId(bookingId)
    .position("captain")
    .build();

CrewAssignmentDto result = assignmentService.assignUserToCrew(assignment);
```

#### –ü–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥—Ä—É–ø–ø

```java
List<CrewDto> availableCrews = crewService.getCrewsByEvent(
    eventId, 
    CrewType.CREW, 
    true // availableOnly
);
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞: crew

#### –¢–∞–±–ª–∏—Ü—ã
- **crews** - –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≥—Ä—É–ø–ø
- **crew_assignments** - –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- **boats** - –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ª–æ–¥–æ–∫
- **tents** - –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–∞–ª–∞—Ç–æ–∫
- **team_preferences** - –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

#### –ò–Ω–¥–µ–∫—Å—ã
- `ix_crews_event` - –ü–æ–∏—Å–∫ –ø–æ —Å–æ–±—ã—Ç–∏—é
- `ix_crews_type` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É
- `ix_crew_assignments_user` - –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `ix_crew_assignments_active` - –ê–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ capacity > 0
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å (event_id, name)
- –ö–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP –∫–æ–¥—ã

- **422 Unprocessable Entity** - –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **404 Not Found** - –ì—Ä—É–ø–ø–∞/–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
- **400 Bad Request** - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **409 Conflict** - –ö–æ–Ω—Ñ–ª–∏–∫—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π

### –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫ (RFC 7807)

```json
{
  "type": "https://api.aquastream.org/errors/crew-capacity-exceeded",
  "title": "–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —ç–∫–∏–ø–∞–∂–∞",
  "status": 422,
  "detail": "–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —ç–∫–∏–ø–∞–∂–∞. –¢–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä: 4, –ú–∞–∫—Å–∏–º—É–º: 4",
  "instance": "/api/v1/assignments",
  "timestamp": "2025-08-20T10:30:00Z",
  "correlationId": "req-abc123"
}
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Check

```bash
GET /actuator/health
```

### Metrics

```bash
GET /actuator/metrics
```

### OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

```bash
GET /swagger-ui.html
GET /v3/api-docs
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã

```bash
./gradlew backend-crew:backend-crew-service:test
```

### Integration —Ç–µ—Å—Ç—ã

```bash
./gradlew backend-crew:backend-crew-api:test
```

### –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–ú–æ–¥—É–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ TestContainers –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö H2.

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- Partial –∏–Ω–¥–µ–∫—Å—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- GIN –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è JSONB –ø–æ–ª–µ–π
- Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- Spring Cache –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Redis –¥–ª—è —Å–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- Stateless —Å–µ—Ä–≤–∏—Å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- Database connection pooling
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- JWT —Ç–æ–∫–µ–Ω—ã —á–µ—Ä–µ–∑ Gateway
- Role-based –¥–æ—Å—Ç—É–ø (ORGANIZER, ADMIN)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker

```dockerfile
FROM openjdk:21-jre-slim
COPY backend-crew-api/build/libs/*.jar app.jar
EXPOSE 8103
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

### Environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```bash
SPRING_PROFILES_ACTIVE=prod
DB_HOST=postgres
DB_PASSWORD=secure_password
REDIS_HOST=redis
JWT_SECRET=secret_key
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ
- Spring Boot 3.x
- Spring Data JPA
- PostgreSQL 15+
- Liquibase
- Swagger/OpenAPI 3

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
- Redis (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- Micrometer (–º–µ—Ç—Ä–∏–∫–∏)
- TestContainers (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)