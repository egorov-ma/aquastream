## Доведение фронтенда до идеала: унификация, бест‑практики, очистка

### Цель

- Привести фронтенд к единым стандартам Tailwind v4 + shadcn/ui и лучшим практикам Next.js 15.
- Устранить технический долг: дубликаты, разрозненные стили, остатки инлайнов и ручной верстки.
- Повысить доступность, производительность, сопровождаемость и переиспользуемость UI.

Ссылки (референсы)
- Tailwind CSS v4 (референс по интеграции): [Using Vite](https://tailwindcss.com/docs/installation/using-vite)
- shadcn - https://ui.shadcn.com/docs/installation/next 

### Область работ

- Весь модуль `frontend/` (приложение Next.js App Router), включая `app/(routes)`, `components/*`, `components/ui/*`, `lib/*`, глобальные стили.

### Не цели (Out of scope)

- Редизайн/изменение бренд‑гайда. Только унификация и повышение качества текущей UI‑системы.
- Масштабные архитектурные изменения бэкенда или контрактов API.

### Результаты (Deliverables)

- Единый, согласованный UI‑кит на базе shadcn/ui + утилиты Tailwind v4.
- Док‑гайдлайны по использованию компонентов и утилит в репозитории.
- Зелёная сборка, чистые линтеры (без ошибок), стабильные e2e.
- Отчёт по Lighthouse со стабильными метриками (см. критерии).

### План работ (эпики и задачи)

1) Чистка и унификация стиля
- Проверить отсутствие CSS‑модулей/кастомных .css (кроме `app/globals.css`).
- Инлайновые стили: разрешены только для задания CSS‑переменных (`--*`). Все визуальные свойства — утилитами Tailwind.
- Проверить и заменить оставшиеся ручные классы кнопок/инпутов на шадцн‑компоненты (`Button`, `Input`, `Textarea`, `Card`, `Alert`, и т.п.).

2) Компонентная унификация (shadcn/ui best‑practices)
- Везде поддержать `className` и мерж через `cn`, варианты — через `cva` (где уместно).
- Фокус/доступность: `focus-visible`/`aria-*` во всех интерактивных.
- Анимации — через `tailwindcss-animate` (замена выполнена), сверить классы в диалогах/меню/tooltip.

3) Формы и элементы ввода
- В проектах форм использовать `Input`, `Textarea`, `Label`, `Button`, `Form` (если есть), без сырых `<input>`/`<textarea>`.
- Связать `label` и `input` по `htmlFor`/`id`, обеспечить `aria-invalid`, `aria-describedby` по необходимости.

4) Таблицы и сортировка
- Сортируемые заголовки таблиц: `Button variant="link" size="sm" className="p-0 h-auto"`, добавить `aria-sort`/`aria-label`.
- Внутри таблиц ссылки — через `Link` (Next.js) с семантикой.

5) Лайауты и слои
- Глобальный layout (уже есть): `ThemeProvider`, `Header`, `main.container`, `Footer`.
- Проверить/выровнять под‑лайауты в `app/(routes)/org/**` на единые отступы/контейнеры.
- Страницы — единый шаблон: `PageHeader` + карточки/секции (`Card`, `Section`).

6) Навигация и ссылки
- Везде `Link` (Next.js) вместо `<a>` для внутренних переходов.
- Ссылки‑кнопки — через `Button asChild` + `variant/size`.

7) Производительность и качество
- Проверить `prefetch`/динамический импорт для тяжёлых блоков.
- Контроль размера первого чанка; lazy‑загрузка второстепенных виджетов.
- Lighthouse target: LCP < 2.5s, TBT < 200ms, CLS < 0.1, Performance ≥ 90 (локально по `pnpm lh`).

8) Доступность (a11y)
- Контраст, фокус‑индикаторы, aria‑атрибуты для интерактива, `aria-live` для статусов.
- Клавиатурная навигация в меню/диалогах (Radix это обеспечивает — проверить кастомные обёртки).

9) Тестирование и CI
- Прогнать e2e (Playwright), дописать сценарии на критические потоки (логин, поиск, бронирование, чек‑аут).
- Линтер/TS — без ошибок. Разрешённые предупреждения — только явно обоснованные.

10) Документация
- Консьюмер‑гайд «Как верстать компонент в проекте»: Tailwind‑утилиты, токены/переменные, `Button asChild`, `buttonVariants`.
- Список типовых шаблонов (страница, секция, таблица, форма, модалка) с примерами.

### Конкретные правки по коду (из известных мест)

- `app/(routes)/events/[eventId]/page.tsx`: заменить ручную кнопку `<button className="mt-4 h-10 rounded-md border px-4 text-sm hover:bg-muted/50">` на `<Button>` (например, `variant="outline" size="lg"`).
- `components/org/OrgEventsTable.tsx`:
  - Заголовки сортировки — `Button variant="link" size="sm" className="p-0 h-auto"` + `aria-sort`/`aria-label`.
  - Ссылка в ячейке — `Link` вместо `<a>`.
- Контейнеры с `rounded-md border p-*` (карточки/статусы) заменить на `Card`/`Alert` где уместно:
  - `components/ui/editorjs.tsx`, `components/ui/states.tsx`, `app/(routes)/org/dashboard/moderation/page.tsx` (статусы), `components/checkout/PaymentWidget.tsx` (alerts), и др.
- Компоненты, использующие `useSearchParams()` внутри дочерних (например, `components/org/EventFilters.tsx`):
  - Убедиться, что родительская страница оборачивает вызов в `<Suspense>`.

### Критерии приёмки (Definition of Done)

- Нет CSS‑модулей и произвольных CSS‑файлов (кроме `app/globals.css`).
- Нет инлайновых стилей, кроме задания CSS‑переменных (`--*`).
- Все кнопки/инпуты/textarea — компоненты shadcn/ui; ссылки‑кнопки — через `Button asChild`.
- Внутренние ссылки — `Link` Next.js. 
- Сортировка таблиц доступна для скринридеров (`aria-sort`, `aria-label`).
- Анимации через `tailwindcss-animate`; все диалоги/меню/tooltip открываются корректно.
- Все страницы используют единый шаблон (контейнер, отступы, `PageHeader` при необходимости).
- Линтер/TS: без ошибок. Сборка `pnpm build` — зелёная.
- Лайтхаус: Performance ≥ 90, LCP < 2.5s, TBT < 200ms, CLS < 0.1 (локально).
- E2E: зелёные базовые сценарии (см. раздел тестирования).

### Риски и смягчение

- Незначительное изменение внешнего вида при замене контейнеров на `Card`/`Alert` — прогнать визуальный просмотр ключевых страниц.
- Неочевидные зависимости от `useSearchParams` — добавить `Suspense` на страницы, если потребуется.

### План выполнения (итеративно)

1. Быстрые правки 
- Заменить остатки ручных кнопок/ссылок/инпутов в упомянутых файлах. 
- Привести сортируемые заголовки таблиц.

2. Унификация контейнеров 
- Перевести статус/инфо‑блоки на `Alert`, карточки на `Card`.

3. Доступность и Suspense 
- `aria-*`, фокус, `aria-live` для статусов. Обернуть страницы с `useSearchParams` в `Suspense`.

4. Тесты и метрики 
- Прогнать e2e, довести Lighthouse до целевых значений, устранить предупреждения ESLint.


### Открытые вопросы

- Нужен ли Storybook/Docs‑витрина для UI‑кита? (может ускорить разработку и снизить регрессии)
- Требуются ли дополнительные варианты у `Button` (например, `xs`, `ghost-danger`) и у `Input` (префиксы/суффиксы)?


